function doPortfolioAnalysis
% doPortfolionAnalysis attempts different strategies to optimize value (outcomes/cost) in a screening system
% It calls screenSystem with the various strategies

POPMIZ1 = 1;
POPMIZ2 = 2;
POPMIZ3 = 3;
POPMIZ4 = 4;
POPURBAN = 5;
POPHEALTHY = 1;
POPUNHEALTHY = 2;
POPVERYHEALTHY = 3;
POPVERYUNHEALTHY = 4;
POPCOMPLIANT = 1;
POPUNCOMPLIANT = 2;
SCREENOPHTH = 1;
SCREENOPTOM = 2;
SCREENTELE = 3;
SCREENNONE = 4;
UTILFEARBLIND = 1;
UTILNEUTRBLIND = 2;
UTILSTOICBLIND = 3;

%% Obtain strategy list
[~,sheets] = xlsinfo('Capstone excel V1.xlsx');
nstrategies = size(sheets,1); %Assume strategy 1 is the base strategy


%% Define ICER calculation parameters
NREPEATS = 3; % How many times we repeat the calculations to ensure low variability
cost = zeros(nstrategies,NREPEATS);
qaly = zeros(nstrategies,NREPEATS);
costMean = zeros(nstrategies);
qalyMean = zeros(nstrategies);

for i = 1 nstrategies
    [num,txt,raw] = xlsread('Capstone excel V1.xlsx')
    nregions = size(num,1); % How many regions we have.
    for j = 1:NREPEATS
        costQaly = screenSystemV1i(nregions,txt(2:nregions+1,1),num(:,1),num(:,2),num(:,3),num(:,4),num(:,5),num(:,6),num(:,7));
        fprintf('Strategy S %.1f %g \n',costQaly);
        cost(1,i) = costQaly(1);
        qaly(1,i) = costQaly(2);
    end
% for i = 1:NREPEATS
%     costQaly = screenSystemV1i(1,{'Montreal'},[1000000],[POPMIZ1],[POPHEALTHY],[POPCOMPLIANT],[10000],[SCREENNONE],[UTILNEUTRBLIND]);
%     fprintf('NONE %.1f %g\n',costQaly);
%     cost(2,i) = costQaly(1);
%     qaly(2,i) = costQaly(2);
% end
% 
meanCost = mean(cost,2);
meanQaly = mean(qaly,2);
for i = 2:nstrategies % Compare each strategy to strategy 1
    icer = (meanCost(i) - meanCost(1)) / (meanQaly(i) - meanQaly(1));
    fprintf('Strategy %d %.2f\n',i,icer);
end

% for i = 1:3
%     x = screenSystemV1i(1,['Montreal'],[1000000],[POPMIZ1],[POPUNHEALTHY],[POPCOMPLIANT],[10000],[SCREENNONE],[UTILNEUTRBLIND]);
%     fprintf('NONE %.1f %f %.1f\n',x(1),x(2),x(1)/x(2));
% end
% 

